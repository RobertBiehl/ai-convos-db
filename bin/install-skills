#!/usr/bin/env bash
set -euo pipefail

target="${1:-both}"
case "$target" in codex|claude|both) ;; *) echo "usage: $0 [codex|claude|both]" >&2; exit 1 ;; esac

root="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
skill="$root/skills/agent-convos/SKILL.md"
[ -f "$skill" ] || { echo "missing skill: $skill" >&2; exit 1; }

install() {
  base="$1"
  mkdir -p "$base/agent-convos"
  cp -f "$skill" "$base/agent-convos/SKILL.md"
  echo "Installed to $base/agent-convos"
}

codex_base="${CODEX_HOME:-$HOME/.codex}/skills"
claude_base="$HOME/.claude/skills"

if [ "$target" = "codex" ] || [ "$target" = "both" ]; then install "$codex_base"; fi
if [ "$target" = "claude" ] || [ "$target" = "both" ]; then install "$claude_base"; fi
